import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Import a CSV file into a Pandas DataFrame
df = pd.read_csv("world-happiness-report-2021.csv")
print(df.head())

# Analysing data

print(df.info())

print(df.index)

print(df.set_index("Country name"))

print(df.describe())

print(df.dtypes)

# Replace missing values or dropping duplicates.
def df_prep(path):
    new_df = pd.read_csv(path)
    new_df.drop_duplicates(inplace=True)
    new_df.fillna("Unknown", inplace=True)
    print(new_df)

for index, row in df.iterrows():
    print(str(row["Regional indicator"]).split(',')[0])

# Looping, iterrows
print(df.columns)
print(df["Regional indicator"].value_counts())


# Regional Insights
print(df.groupby('Regional indicator')['Ladder score'].mean().reset_index().sort_values('Ladder score'))

print(df.groupby('Regional indicator')[['Ladder score', 'Logged GDP per capita', 'Social support', 'Healthy life expectancy',
                                  'Freedom to make life choices', 'Generosity',
                                  'Perceptions of corruption']].mean().reset_index().sort_values('Ladder score'))
