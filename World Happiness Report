import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Import a CSV file into a Pandas DataFrame
df = pd.read_csv("world-happiness-report-2021.csv")
print(df.head())

df_past = pd.read_csv("world-happiness-report.past.csv")
print(df_past.head())



# Analysing data

print(df.info())

print(df.index)

print(df.set_index("Country name"))

print(df.describe())

print(df.dtypes)

# Replace missing values or dropping duplicates
def df_prep(path):
    new_df = pd.read_csv(path)
    new_df.drop_duplicates(inplace=True)
    new_df.fillna("Unknown", inplace=True)
    print(new_df)


# Looping, iterrows
for index, row in df.iterrows():
    print(str(row["Regional indicator"]).split(',')[0])

# Merge DataFrames
inner_merge = pd.merge(left=df, right=df_past, left_on="Country name", right_on="Country name")
print(inner_merge)

# Regional Insights
print(df.columns)
print(df["Regional indicator"].value_counts())

print(df.groupby('Regional indicator')['Ladder score'].mean().reset_index().sort_values('Ladder score'))

print(df.groupby('Regional indicator')[['Ladder score', 'Logged GDP per capita', 'Social support', 'Healthy life expectancy',
                                  'Freedom to make life choices', 'Generosity',
                                  'Perceptions of corruption']].mean().reset_index().sort_values('Ladder score'))

# Dict Top ranking happiest countries

Top3 = {"Country name":["Finland", "Denmark", "Switzerland"], "Ladder score":[7.842, 7.620, 7.571]}
Top_Ranking = pd.DataFrame(Top3)
print(Top_Ranking)




plt.figure(figsize=(15,20))
sns.relplot(x="Perceptions of corruption", y="Ladder score", hue="Regional indicator", data=df
            , alpha=1.5, palette='rocket', s=110);
plt.title("Happiness score vs Perceptions of corruption", fontsize="15")
plt.show()





